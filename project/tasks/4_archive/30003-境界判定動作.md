---
id: "30003"
title: "境界判定動作"
type: "game-dev"
status: "done"
priority: "high"
spec_ids: ["30503"]
blocked_by: ["30001", "30002"]
blocks: []
branch_name: null
worktree_path: null
plan_file: null
tags: ["court", "mvp", "phase1"]
created_at: "2026-01-06T20:00:00+09:00"
updated_at: "2026-01-06T21:00:00+09:00"
completed_at: "2026-01-06T21:00:00+09:00"
---

# Task 30003: 境界判定動作

## Summary

プレイヤーとボールの境界判定動作を実装する。

## Related Specifications

- [30503_boundary_behavior.md](../../docs/3_ingame/305_court/30503_boundary_behavior.md)

## 実装内容

- [x] プレイヤー移動制限（コート境界で停止）
- [x] ボール反射トリガー
- [x] 境界に沿った移動許可

## Dependencies

- **Blocked By:** 30001, 30002
- **Blocks:** なし

## 実装完了

### 追加したファイル
- `project/src/components/mod.rs` - Player, Ball, Velocity, BounceCount コンポーネント
- `project/src/systems/boundary.rs` - 境界判定システム（BoundaryPlugin）

### 修正したファイル
- `project/src/core/events.rs` - NetHitEvent, GroundBounceEvent 追加
- `project/src/systems/mod.rs` - boundaryモジュール追加
- `project/src/main.rs` - BoundaryPlugin追加

### 実装内容
1. **プレイヤー境界制限** (BEH-30503-001, 002, 003)
   - 左右壁制限: Position.X をクランプ、Velocity.X = 0
   - 前後壁制限: Position.Z をクランプ、Velocity.Z = 0
   - ネット通過禁止: 自コート側に制限

2. **ボール境界処理** (BEH-30503-004, 005, 006, 007)
   - 壁反射トリガー: WallReflectionEvent発行
   - ネット接触判定: NetHitEvent発行
   - 地面バウンド: GroundBounceEvent発行
   - 境界チェック優先順位: ネット > 地面 > 壁 > 天井

### テスト
- 27テスト全てパス

## メモ

- Court構造の最終タスク
- Bevy 0.17 API変更対応（Event → Message）
