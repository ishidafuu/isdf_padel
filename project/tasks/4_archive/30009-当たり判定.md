---
id: "30009"
title: "当たり判定"
type: "game-dev"
status: "done"
priority: "high"
spec_ids: ["30403"]
blocked_by: ["30004", "30007"]
blocks: ["30013"]
branch_name: null
worktree_path: null
plan_file: null
tags: ["ball", "mvp", "phase1"]
created_at: "2026-01-06T20:00:00+09:00"
updated_at: "2026-01-07T00:00:00+09:00"
completed_at: "2026-01-07T00:00:00+09:00"
---

# Task 30009: 当たり判定

## Summary

ボールとキャラクターの当たり判定を実装する。

## Related Specifications

- [30403_collision_spec.md](../../docs/3_ingame/304_ball/30403_collision_spec.md)

## 実装内容

- [x] REQ-30403-001: プレイヤーとの当たり判定（球体-球体衝突）
- [x] REQ-30403-002: BallHitEvent発行
- [x] REQ-30403-003: 無敵時間中の衝突無視
- [x] REQ-30403-004: ボール反射（プレイヤー衝突時）
- [x] REQ-30403-005: 衝突判定頻度（Updateシステム）
- [x] REQ-30403-006: 複数プレイヤー衝突時の優先順位（最近プレイヤー優先）

## Dependencies

- **Blocked By:** 30004（プレイヤー移動）, 30007（ボール軌道）
- **Blocks:** 30013（ポイント進行）

## 実装ファイル

- `project/src/systems/ball_collision.rs` - 当たり判定システム
  - `BallCollisionPlugin` - プラグイン
  - `ball_player_collision_system` - 衝突判定システム

## メモ

- config.Ball.Radius, config.Collision.CharacterRadius を参照
- config.Collision.ZTolerance でZ軸許容範囲を判定
- BallHitEvent でふっとばしシステム（knockback.rs）と連携
