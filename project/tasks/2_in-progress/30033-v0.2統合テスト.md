---
id: "30033"
title: "v0.2統合テスト・バランス調整"
type: game-dev
status: in-progress
priority: high
created: 2026-01-08
updated_at: "2026-01-08T11:45:00+09:00"
depends_on:
  - "30032"
spec_refs:
  - "30010_v02_scope.md"
  - "30604_shot_attributes_spec.md"
  - "30301_ai_movement_spec.md"
  - "30302_ai_shot_spec.md"
---

# 30033: v0.2統合テスト・バランス調整

## 概要

v0.2の完成定義を全て満たしているか確認し、必要なバランス調整を行う。

## v0.2 完成定義チェックリスト

### ショットシステム

- [ ] 5要素によるショット属性の無段階変化が動作する
  - [ ] 入力方式（プッシュ精度/ホールド時間）
  - [ ] 打点の高さ（Y座標）
  - [ ] バウンド経過時間
  - [ ] ボールへの入り方（移動ベクトル）
  - [ ] ボールとの距離
- [ ] 属性（威力、安定性、角度、スピン、精度）が計算される
- [ ] 属性に応じてボールの軌道が変化する
- [ ] ホールドの「構え」が視覚的にわかる

### AIシステム

- [ ] AIがショット属性システムを使用する
- [ ] AIが状況に応じたポジショニングをする
- [ ] AIの難易度調整パラメータがある
- [ ] 1人プレイとして成立する

### 技術要件

- [ ] 全パラメータが外部データ化されている
- [ ] カーブ係数がキャラ別に設定可能な構造になっている（将来対応）

## 検証手順

1. ゲームを起動 (`/run-game`)
2. 各項目を手動でテスト
3. 問題があればパラメータ調整
4. 再テスト

## バランス調整対象パラメータ

- `shot_attributes.base_power`
- `shot_attributes.base_stability`
- `shot_attributes.height_curve`
- `shot_attributes.timing_curve`
- `ai.move_speed`
- `ai.shot_cooldown`

## 受け入れ条件

- [ ] 上記チェックリストが全て完了
- [ ] ラリーが成立する
- [ ] AIが適切に返球する
- [ ] ショット属性が体感できる

## Progress

### Completed

- [x] ゲーム起動・動作確認
- [x] AI移動システムのクエリ競合修正（Without<T>追加）
- [x] 2PをAI専用に変更（キー操作無効化）
- [x] 打球高さ制限追加（max_height_diff: 2.0m）
- [x] ふっとばし機能を一時無効化（enabled フラグ追加、ボール反射も含む）

## Next Actions

1. v0.2完成定義チェックリストを順次検証
2. ショットシステムの5要素が機能しているか確認
3. AIシステムの動作確認
4. 必要に応じてバランス調整

## メモ

- 高いボールが打てる問題を修正（ball_collision.rsに高さ制限追加）
- 距離計算をXY平面からXZ平面（水平距離）に変更
- テストは全て通過
- ふっとばし機能は仕様確定後に再有効化予定（game_config.ron の knockback.enabled: true に変更）
