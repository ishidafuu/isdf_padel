---
id: "30006"
title: "ふっとばし機能"
type: "game-dev"
status: "in-progress"
priority: "high"
spec_ids: ["30203"]
blocked_by: ["30004"]
blocks: []
branch_name: null
worktree_path: null
plan_file: null
tags: ["player", "mvp", "phase1"]
created_at: "2026-01-06T20:00:00+09:00"
updated_at: "2026-01-07T00:00:00+09:00"
completed_at: null
---

# Task 30006: ふっとばし機能

## Summary

ボールがプレイヤーに当たった時のふっとばし挙動を実装する。

## Related Specifications

- [30203_knockback_spec.md](../../docs/3_ingame/302_player/30203_knockback_spec.md)

## 実装内容

- [x] REQ-30203-001: ふっとばし開始（BallHitEvent受信、速度・方向設定）
- [x] REQ-30203-002: ふっとばし移動
- [x] REQ-30203-003: ふっとばし中の境界制限
- [x] REQ-30203-004: ふっとばし終了
- [x] REQ-30203-005: 無敵時間の管理
- [x] REQ-30203-006: 操作不能時間の管理
- [x] REQ-30203-007: PlayerKnockbackEvent の発行
- [x] REQ-30203-008: ふっとばし中の重力適用

## 実装ファイル

- `project/src/components/mod.rs` - KnockbackState 拡張（invincibility_time追加）
- `project/src/core/events.rs` - PlayerKnockbackEvent, BallHitEvent 更新
- `project/src/systems/knockback.rs` - 新規作成（knockback_start_system, knockback_movement_system, knockback_timer_system）
- `project/src/systems/mod.rs` - knockback モジュール追加
- `project/src/main.rs` - システム・イベント登録

## Dependencies

- **Blocked By:** 30004（プレイヤー移動）- 完了済み
- **Blocks:** なし

## メモ

- config.Knockback.Duration, SpeedMultiplier, InvincibilityTime を参照
- BallHitEvent をリッスンしてふっとばし開始
- 無敵時間中は再被弾しない
- ふっとばし中も重力が適用される
