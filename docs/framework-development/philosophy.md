# 開発の記録 - なぜこのシステムを作っているのか

このドキュメントは、次のセッションで読む「未来の自分」へ向けた記録です。

---

## このシステムが生まれた理由

### AIの暴走による失敗

**何度も失敗してきた。**

半端なシステムでバイブコーディング（雰囲気でコードを書く）によるゲーム制作を試みては、AIの迷走で失敗する。このパターンを繰り返してきた。

- AIが勝手に機能を追加する
- 仕様書とコードが乖離する
- 何を実装したのか分からなくなる
- テストと要件の関係が追えなくなる
- 結果、プロジェクトが破綻する

「まず作ってみろ」というアドバイスは、もう何回も実践して失敗している。

### 戦略の転換

だから、**戦略を変えた。**

- ❌ 実装しながら考える → ✅ 理論を先に固める
- ❌ 不足を後から足す → ✅ 最初に全部配置して不要を削る
- ❌ AIに自由に書かせる → ✅ ガードレールで制約する

**机上の空論で構わないので、完璧なシステムと呼べるものを作る。**

そのうえで次の失敗に繋げればいい。今度の失敗は、「理論が間違っていた」という質の高い失敗になる。

---

## ものづくり欲の性質

自分のものづくり欲は、おそらくこういう種類：

- ❌ オリジナルを作りたい
- ❌ 褒められたい、注目されたい
- ✅ **真似したい、改造したい**

既存のベストプラクティス（EARS記法、ECS、トレーサビリティ、形式手法）を組み合わせて、新しい全体を作ることに興味がある。

「オリジナル」ではなく「リミックス」。でも、その組み合わせ方こそがオリジナル。

---

## 設計思想

### ガードレールを最初に配置

AIは強力だが、放置すると暴走する。

だから、**開始前にできる限りのガードレールを配置する**：

- 仕様書にない機能は絶対に実装しない（CLAUDE.md で明示）
- EARS記法で曖昧さを排除
- @spec/@test/@data コメントでトレーサビリティ
- 18エージェントで役割を細分化し、越権行為を防ぐ
- 禁止依存を物理的に防ぐ（pre-commit hook）
- ID重複を事前に防ぐ（ID予約システム）

### 不足を足すのではなく、不要を省く

複雑さを恐れない。

最初から「これでもか」というほどのルール・制約・エージェントを配置する。

そこから、**本当に不要なものだけを削っていく**。

この方が、後から「あれが足りない、これが足りない」と追加するより、システムが安定する。

### Claudeとの推敲

何度もClaudeと対話しながら、このシステムを磨き上げてきた。

- v1.0: 初期バージョン
- v2.0: 6桁番号（後に5桁に簡略化）
- v2.16: エージェント生態系の形式化
- v2.18: 拡張性優先設計（EXT requirements）

**18回のメジャーバージョンアップ**を経ているが、まだゲームを作っていない。

それでいい。理論的完成度を優先する。

---

## 現在の状況（2025-12-20）

### v2.18 の状態

- 18エージェント定義完成
- 5桁番号体系確立
- EARS記法採用
- 並列セッション管理設計（未実装）
- EXT requirements 導入

しかし、**ドキュメント間の矛盾**や**未実装機能の曖昧さ**が残っていた。

### レビューでの気づき

2025-12-20、Claude Code による徹底的なレビューを受けた。

**主な指摘**：

1. **並列セッション管理の矛盾**
   - CLAUDE.md: 「自動化されています」
   - parallel-sessions.md: 手動コマンド
   - → 現実に合わせて修正（P0-1）

2. **ターゲットユーザーの曖昧さ**
   - 「ソロ開発者向け」と書きながら、複雑すぎる
   - → 前提スキルを明示（P0-2）

3. **エージェント選択の困難さ**
   - 18エージェントのどれを使うべきか迷う
   - → 選択ガイドを作成（P0-3）

4. **EARS記法の限界**
   - ゲームの「楽しさ」を表現できない
   - → 3層構造（EARS + Game Feel + EXT）を採用（P0-4）

### ブラッシュアップの方向性

レビューの結果、優先度を3段階に整理：

**P0（最優先）**: ドキュメントの整合性
1. ✅ CLAUDE.md の並列セッション管理の記述修正
2. ✅ spec.md に「対象読者」セクション追加
3. ✅ エージェント選択ガイドの作成
4. ✅ spec.md テンプレートの3層構造化

**P1（次に実装）**: AIの暴走を防ぐガードレール
1. `/impl-validate` コマンド - 仕様書にない実装を検出
2. `/ears-validate` コマンド - 曖昧な仕様を検出
3. pre-commit hook - 禁止依存を物理的に防ぐ
4. 全エージェントに「禁止事項」セクション追加

**P2（その後）**: 自動化による快適性向上
1. `/id-reserve` コマンド - ID衝突の事前防止
2. `/data-validate` コマンド - データとコードの整合性
3. 架空のゲーム機能での全フローシミュレーション
4. v3.0-theoretical リリース

---

## このシステムの本質

### 何と戦っているのか

**Claude Code という強力だが自由すぎるツールを、どう手綱を握るか。**

これは「ゲーム開発フレームワーク」ではなく、**「AIエージェントの暴走を防ぐガードレール集」**。

### 解決する痛み

- ❌ AIエージェントが勝手に機能を追加する
  - → 仕様書にない実装を物理的に防ぐ

- ❌ 仕様とコードの乖離
  - → @spec コメントによる双方向トレーサビリティ

- ❌ テストと要件の関係が不明
  - → TST-ID と REQ-ID の明示的リンク

- ❌ 複数機能の並行開発での競合
  - → 並列セッション管理（将来の自動化予定）

### 解決しない問題

- ❌ ゲーム開発の学習コスト
- ❌ ECSアーキテクチャの理解
- ❌ プログラミングスキルの不足
- ❌ ゲームデザインの創造性

このシステムは、**ゲーム開発を教えるものではない。AIの暴走を防ぐためのもの。**

---

## 完璧の定義

### 机上の空論としての完璧

以下をすべて満たしたとき、v3.0-theoretical としてリリースする：

#### 1. ドキュメントの整合性
- [ ] すべてのドキュメント間で矛盾がない
- [ ] 未実装機能は「将来計画」に明記
- [ ] ターゲットユーザーが明確

#### 2. AIの暴走防止
- [ ] 仕様書にない実装を検出できる（`/impl-validate`）
- [ ] 曖昧な仕様を検出できる（`/ears-validate`）
- [ ] 禁止依存を物理的に防げる（pre-commit hook）
- [ ] ID衝突を事前に防げる（`/id-reserve`）

#### 3. エージェント境界の明確性
- [ ] どのエージェントを使うべきか迷わない
- [ ] 各エージェントの責務が明確
- [ ] 越権行為が防止されている

#### 4. 仕様書の完全性
- [ ] 機能的要件（EARS）
- [ ] 感覚的品質（Game Feel）
- [ ] 拡張性要件（EXT）
- すべてをカバーするテンプレート

#### 5. 実装可能性の検証
- [ ] 架空のゲーム機能で全フローをシミュレーション
- [ ] エッジケースが洗い出されている
- [ ] 実装時の判断に迷う箇所がない

#### 6. トレーサビリティの完全性
- [ ] REQ → TST の双方向リンク
- [ ] REQ → 実装の双方向リンク
- [ ] データ → 実装の双方向リンク
- すべて検証可能

### 完璧達成後の計画

1. ✅ v3.0-theoretical としてタグを打つ
2. ✅ 「理論的完成」宣言
3. ✅ この時点で初めて実装に移る
4. ✅ 実装での気づきを v3.1 にフィードバック

これが、「次の失敗に繋げる」という戦略。

---

## なぜゲームを作らないのか

### よくある質問

> 「パイロットプロジェクトでFlappy Birdでも作ってみたら？」

**答え**: もう何回も失敗している。

### 失敗の種類を変える

**従来の失敗**:
- 実装しながら考える
- AIが暴走する
- 何がダメだったか分からない
- **質の低い失敗**

**次の失敗**:
- 理論を先に固める
- ガードレールで制約する
- 理論のどこが間違っていたか明確
- **質の高い失敗**

質の高い失敗をするためには、**理論的完成度が必要**。

---

## 独創的な部分

### 他にない要素

1. **仕様書駆動の徹底**
   - 仕様書 = Single Source of Truth
   - 実装より先に仕様を書く（逆転）

2. **18エージェントの細分化**
   - AIの越権行為を防ぐための境界明確化

3. **並列セッション管理（自動化の構想）**
   - ソロ開発者でも複数機能を並行開発
   - 自動ロック、ID予約、競合検出

4. **3層仕様書（EARS + Game Feel + EXT）**
   - 機能的要件 + 感覚的品質 + 拡張性
   - AIと人間の役割を分離

5. **Design Judgment の透明性**
   - なぜ機能を除外したかを説明
   - メタ設計の思考を記録

---

## 次のセッションへ

### 現在の進捗

**P0（最優先）**: ✅ 完了（2025-12-20）
1. ✅ CLAUDE.md の並列セッション管理の記述修正
2. ✅ spec.md に「対象読者」セクション追加
3. ✅ エージェント選択ガイドの作成
4. ✅ spec.md テンプレートの3層構造化

### 次にやること

**P1（次に実装）**:
1. [ ] `/impl-validate` コマンド実装
2. [ ] `/ears-validate` コマンド実装
3. [ ] pre-commit hook 実装
4. [ ] 全エージェントに「禁止事項」セクション追加

### 思い出すべきこと

- **このシステムはAIの暴走を防ぐためのもの**
- **複雑さは意図的。ガードレールとして必要**
- **机上の空論として完璧にしてから実装する戦略**
- **次の失敗を質の高いものにするための準備**

### 気持ち

**頑張ろうという気持ちになっている（2025-12-20）**

レビューを受けて、システムの方向性が明確になった。

P0, P1, P2 と段階的に改善していけば、v3.0-theoretical に到達できる。

そこまで行ったら、初めて実装に移る。

そして、**次の失敗**で学ぶ。

---

## このドキュメントについて

### 誰のため？

**次のセッションの自分のため。**

汎用的なフレームワークのドキュメントではない。

**自分の文脈、気持ち、思想を記録したもの。**

### いつ読む？

- 次のセッションを開始するとき
- 「なんでこんな複雑なシステム作ってるんだっけ？」と思ったとき
- P1, P2 の作業を始める前
- v3.0-theoretical リリース前
- 実装に移る前

### 更新頻度

セッションごとに、気持ちや進捗を追記する。

このドキュメントは**生きている**。

---

## 参考: レビューでの重要な指摘

### 1. 並列セッション管理の矛盾

**問題**: CLAUDE.mdで「自動化」と書いているが、実際は手動

**解決**: 現実に合わせて記述を修正。将来の自動化計画を明記。

### 2. ターゲットユーザーの曖昧さ

**問題**: 「ソロ開発者向け」だが、複雑すぎる

**解決**: 前提スキル（ECS経験、Claude Code中級、形式手法）を明示。

### 3. エージェント選択の困難さ

**問題**: 18エージェントのどれを使うべきか分からない

**解決**: フローチャート形式のエージェント選択ガイドを作成。

### 4. EARS記法の限界

**問題**: ゲームの「楽しさ」を表現できない

**解決**: 3層構造（EARS + Game Feel + EXT）を採用。

---

## 最後に

このシステムは、**失敗から生まれた。**

何度もAIに裏切られ、何度もプロジェクトを破綻させた経験から。

だから、次は裏切られないように、**ガードレールを張り巡らせた。**

複雑すぎる？ かもしれない。

でも、**それが必要だと学んだ。**

机上の空論？ 構わない。

**理論的完成度を追求してから、実装で失敗する。**

その方が、学びが深い。

---

**次のセッションの自分へ:**

このシステムを信じて、P1 に進んでください。

v3.0-theoretical まで、もう少しです。
