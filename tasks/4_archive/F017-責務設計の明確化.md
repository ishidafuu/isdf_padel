---
id: "F017"
title: "責務設計の明確化"
type: "framework"
status: "done"
priority: "low"
created_at: "2026-01-04T12:00:00+09:00"
started_at: "2026-01-04T14:30:00+09:00"
completed_at: "2026-01-04T15:00:00+09:00"
blocked_by: ["F014", "F015", "F016"]
blocks: []
tags: ["architecture", "design", "optional"]
---

# F017: 責務設計の明確化

## 概要

エージェント間の責務重複や曖昧性を解消し、設計を明確化する。
このタスクは任意（optional）であり、F014〜F016完了後に検討する。

## 背景

精査結果（パート2,4）で以下の設計上の曖昧性が発見された：
- セッション管理が複数エージェントに分散
- 仕様修正の責務がimpl-agent/spec-agent間で曖昧
- task-status.mdの位置づけ（スキル or コマンド実装）が不明確

## 検討事項

### 1. セッション管理の一元化
**現状**: design-agent, impl-agent, task-manager-agent が各自でworktree管理
**案**: session-manager-agent に集約し、他は「確認のみ」に限定

### 2. 仕様修正責務の明確化
**現状**: impl-agentが発見した矛盾を誰が修正するか不明確
**案**:
- impl-agent: 矛盾を発見 → review-agentに報告
- review-agent: 修正が必要か判断 → spec-agentに返却
- spec-agent: 仕様を修正

### 3. task-status.mdの位置づけ決定
**現状**: skills/に配置だが、内容はコマンド実装仕様
**案A**: スキルとして維持（内部実装ドキュメント）
**案B**: 削除（/task-statusコマンドは実装しない方針のため）

### 4. その他の曖昧性解消
- legacy-analyzer vs game-reference の使い分けマトリックス追加
- Progress記録の重複（review-agent vs impl-agent）解消

## 作業内容

- [x] セッション管理の責務を再定義 → **現状は適切**（docs/concepts/agents.md に使い分けマトリックス追加）
- [x] 仕様修正フローを明確化 → **現状は適切**（impl→review→spec のフローが既に定義済み）
- [x] task-status.mdの位置づけを決定 → **スキルとして維持**（説明を「エージェント向けガイドライン」に修正）
- [x] legacy-analyzer vs game-reference 使い分け → docs/concepts/agents.md に追加

## 分析結果

### 1. セッション管理（問題なし）
- session-manager: 並列セッションの**一括**準備
- task-manager: 個別タスクの**単発**作成
- 他エージェント: **確認のみ**（重複ではなく補完関係）

### 2. 仕様修正フロー（問題なし）
- impl-agent → review-agent → spec/design-agent のフローが既に定義済み

### 3. task-status.md
- スキルとして維持、説明を修正（「人間専用コマンド」→「エージェント向けガイドライン」）

### 4. Progress記録（問題なし）
- impl-agent: 実装コミット記録
- review-agent: レビュー結果記録
- 重複ではなく補完関係

## 完了条件

- [x] 責務の曖昧性が解消されている（分析の結果、大きな問題なし）
- [x] エージェント定義が更新されている（docs/concepts/agents.md に使い分けマトリックス追加）
- [x] CLAUDE.mdに反映されている（必要な場合）→ 今回は不要
- [x] コミット完了

## 備考

このタスクは **任意（optional）** です。
F014〜F016で基本的な整合性が確保された後、必要に応じて実施を検討してください。

## 関連

- 精査プラン: `~/.claude/plans/sharded-stargazing-porcupine.md`
- 関連タスク: F014, F015, F016
